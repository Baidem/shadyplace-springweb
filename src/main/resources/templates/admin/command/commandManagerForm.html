<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
>
<head>
  <meta charset="UTF-8">
  <title>Manage command</title>
  <div th:replace="fragments/links-global">...</div>
</head>

<body class="">

<header th:replace="fragments/header.html :: header">...</header>

<header th:replace="fragments/navbar.html :: navbar">...</header>

<main>
  <!--/* Title */-->
  <section>
    <div class="container-fluid">
      <div class="row ">
        <div class="col">
          <h1 th:text="'Manage command #' + ${command.id}"></h1>
        </div>
      </div>
    </div>
  </section>

  <!--/* Command Card and Validation Form */-->
  <section>
    <div class="container-fluid">
      <div class="row">
        <div class="col-auto">
          <div class="card shadow">
            <div class="card-body">
              <h5 class="card-title" th:text="'Command #' + ${command.id}"></h5>
              <ul class="list-group list-group-flush">
                <li class="list-group-item" th:text="'Created at: ' + ${#dates.format(command.createdAt.time, 'dd-MM-yyyy')}"></li>
                <li class="list-group-item" th:text="'Price: ' + ${command.totalPrice} + ' €'"></li>
                <li class="list-group-item" th:text="'Payment: ' + ${command.paymentStatus.label}"></li>
                <li class="list-group-item" th:text="'Validation: ' + ${command.validationStatus.label}"></li>
                <li class="list-group-item" th:text="'Comment: ' + ${command.comment}"></li>
                <li class="list-group-item" th:text="'User: ' + ${command.user.firstname + ' ' + command.user.lastname}"></li>
                <li class="list-group-item"><a class="text-primary" th:href="'mailto:' + ${command.user.email}" th:text="'Email' + ${command.user.email}"></a></li>
              </ul>
              <!-- /* Form */ -->
              <form id="validationForm"  method="post">

                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

                <div class="d-flex gap-1">
                  <div class="col-auto btn-group shadow-sm" role="group" aria-label="Basic radio toggle button group">
                    <input type="radio" class="btn-check" name="commandStatus" id="validatedCommand" autocomplete="off" value="validated">
                    <label class="btn btn-outline-secondary btn-sm" for="validatedCommand">
                      <i class="fa-regular fa-thumbs-up me-1"></i>
                      Validated command
                    </label>

                    <input type="radio" class="btn-check" name="commandStatus" id="refusedCommand" autocomplete="off" value="refused">
                    <label class="btn btn-outline-secondary btn-sm" for="refusedCommand">
                      <i class="fa-regular fa-thumbs-down me-1"></i>
                      Refused command
                    </label>
                  </div>

                  <div>
                    <button
                      type="submit"
                      class="btn btn-success btn-sm bg-gradient w-100 text-light shadow-sm"
                    >
                      <i class="fa-solid fa-share-from-square me-1"></i>
                      Submit
                    </button>
                  </div>
                  <div>
                    <a
                      th:href="@{/admin/commands-manager#navbar}"
                      class="btn btn-sm btn-secondary"
                    >
                      <i class="fa-solid fa-list me-1"></i>Back to the list
                    </a>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- /* Table */ -->
  <section>
    <div class="container-fluid">
      <div class="row">
        <div class="col">
          <h2 class="">Details command</h2>
          <table class="table table-warning table-striped shadow m-0">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">Stay date</th>
                <th scope="col">Price</th>
                <th scope="col">Equipments</th>
                <th scope="col">Line</th>
                <th scope="col">Location</th>
                <th scope="col">Fidelity Rank</th>
                <th scope="col">Family link</th>
                <th scope="col">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="booking : ${command.bookings}" class="table-warning">
                <th scope="row" th:text="${booking.id}"></th>
                <td th:text="${#dates.format(booking.bookingDate.time, 'dd-MM-yyyy')}"></td>
                <td th:text="${booking.bookingPrice + ' €'}"></td>
                <td th:text="${booking.line.label}"></td>
                <td th:text="${booking.equipment.option}"></td>
                <td th:text="${booking.location != null ? 'Line: ' + #strings.toString(booking.location.lineNumber) + ', Rank: ' + #strings.toString(booking.location.lineNumber) : '-'}"></td>
                <td th:text="${booking.fidelityRank.label}"></td>
                <td th:text="${command.user.familyLink.label}"></td>
                <td>
                  <a
                     th:href="@{'/admin/location-automatic/' + ${booking.id}}"
                     class="btn-switch-status btn btn-sm btn-secondary" >
                    <i class="fa-solid fa-robot me-1"></i>Auto location
                  </a>
                  <a
                     th:href="@{'/admin/location-manually/' + ${booking.id}}"
                     class="btn-switch-status btn btn-sm btn-secondary" >
                    <i class="fa-solid fa-map me-1"></i>Map location
                  </a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </section>



</main>

<footer th:replace="fragments/footer.html :: footer">...</footer>

<div th:replace="fragments/scripts-js.html">...</div>

<script>
</script>

</body>
</html>